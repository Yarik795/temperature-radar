<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–¢–µ—Å—Ç –ª–æ–≥–∏–∫–∏ –æ–∫—Ä—É–≥–ª–µ–Ω–∏—è —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .test-section { margin: 20px 0; padding: 15px; border: 1px solid #ddd; border-radius: 8px; }
        .result { margin: 10px 0; padding: 10px; background: #f0f0f0; border-radius: 4px; }
        .success { background: #d4edda; color: #155724; }
        .error { background: #f8d7da; color: #721c24; }
        input, button { margin: 5px; padding: 8px; }
    </style>
</head>
<body>
    <h1>üß™ –¢–µ—Å—Ç –ª–æ–≥–∏–∫–∏ –æ–∫—Ä—É–≥–ª–µ–Ω–∏—è —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä</h1>
    
    <div class="test-section">
        <h3>–¢–µ—Å—Ç 1: –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–∫—Ä—É–≥–ª–µ–Ω–∏—è</h3>
        <p>–í–≤–µ–¥–∏—Ç–µ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—É –∏ –¥–æ–ø—É—Å–∫ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:</p>
        <input type="number" id="testTemp" value="24" step="0.1" placeholder="–¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞">
        <input type="number" id="testTol" value="1" step="0.1" placeholder="–î–æ–ø—É—Å–∫">
        <button onclick="testRounding()">–¢–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å</button>
        <div id="roundingResult" class="result"></div>
    </div>

    <div class="test-section">
        <h3>–¢–µ—Å—Ç 2: –ò–º–∏—Ç–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –∏–∑ CSV</h3>
        <p>–¢–µ—Å—Ç–∏—Ä—É–µ–º —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏ –∏–∑ –≤–∞—à–µ–≥–æ —Ñ–∞–π–ª–∞:</p>
        <button onclick="testWithRealData()">–¢–µ—Å—Ç —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏</button>
        <div id="realDataResult" class="result"></div>
    </div>

    <div class="test-section">
        <h3>–¢–µ—Å—Ç 3: –ü–æ–∏—Å–∫ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä</h3>
        <p>–ù–∞–π–¥–µ–º –≤—Å–µ –∑–∞–ø–∏—Å–∏ –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã:</p>
        <input type="number" id="searchTemp" value="6" step="0.1" placeholder="–ò—Å–∫–∞—Ç—å —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—É">
        <input type="number" id="searchTol" value="0.5" step="0.1" placeholder="–î–æ–ø—É—Å–∫">
        <button onclick="searchTemperature()">–ò—Å–∫–∞—Ç—å</button>
        <div id="searchResult" class="result"></div>
    </div>

    <script>
        // –ò–º–∏—Ç–∏—Ä—É–µ–º –¥–∞–Ω–Ω—ã–µ –∏–∑ CSV (–ø–µ—Ä–≤—ã–µ –Ω–µ—Å–∫–æ–ª—å–∫–æ –∑–∞–ø–∏—Å–µ–π)
        const mockData = [
            { timestamp: '20240101T0000', temperature: 6.5302453, dayOfYear: 1, hour: 0 },
            { timestamp: '20240101T0100', temperature: 6.2402453, dayOfYear: 1, hour: 1 },
            { timestamp: '20240101T0200', temperature: 5.9502453, dayOfYear: 1, hour: 2 },
            { timestamp: '20240101T0300', temperature: 5.6602453, dayOfYear: 1, hour: 3 },
            { timestamp: '20240101T0400', temperature: 5.3702453, dayOfYear: 1, hour: 4 },
            { timestamp: '20240101T0500', temperature: 5.0802453, dayOfYear: 1, hour: 5 },
            { timestamp: '20240101T0600', temperature: 4.7902453, dayOfYear: 1, hour: 6 },
            { timestamp: '20240101T0700', temperature: 4.5002453, dayOfYear: 1, hour: 7 },
            { timestamp: '20240101T0800', temperature: 4.2102453, dayOfYear: 1, hour: 8 },
            { timestamp: '20240101T0900', temperature: 3.9202453, dayOfYear: 1, hour: 9 },
            { timestamp: '20240101T1000', temperature: 3.6302453, dayOfYear: 1, hour: 10 },
            { timestamp: '20240101T1100', temperature: 3.3402453, dayOfYear: 1, hour: 11 },
            { timestamp: '20240101T1200', temperature: 3.0502453, dayOfYear: 1, hour: 12 },
            { timestamp: '20240101T1300', temperature: 2.7602453, dayOfYear: 1, hour: 13 },
            { timestamp: '20240101T1400', temperature: 2.4702453, dayOfYear: 1, hour: 14 },
            { timestamp: '20240101T1500', temperature: 2.1802453, dayOfYear: 1, hour: 15 },
            { timestamp: '20240101T1600', temperature: 1.8902453, dayOfYear: 1, hour: 16 },
            { timestamp: '20240101T1700', temperature: 1.6002453, dayOfYear: 1, hour: 17 },
            { timestamp: '20240101T1800', temperature: 1.3102453, dayOfYear: 1, hour: 18 },
            { timestamp: '20240101T1900', temperature: 1.0202453, dayOfYear: 1, hour: 19 },
            { timestamp: '20240101T2000', temperature: 0.7302453, dayOfYear: 1, hour: 20 },
            { timestamp: '20240101T2100', temperature: 0.4402453, dayOfYear: 1, hour: 21 },
            { timestamp: '20240101T2200', temperature: 0.1502453, dayOfYear: 1, hour: 22 },
            { timestamp: '20240101T2300', temperature: -0.1397547, dayOfYear: 1, hour: 23 }
        ];

        function testRounding() {
            const targetTemp = parseFloat(document.getElementById('testTemp').value);
            const tolerance = parseFloat(document.getElementById('testTol').value);
            
            let result = `<h4>–¢–µ—Å—Ç –¥–ª—è ${targetTemp}¬∞C ¬±${tolerance}¬∞C:</h4>`;
            result += `<p><strong>–î–∏–∞–ø–∞–∑–æ–Ω –ø–æ–∏—Å–∫–∞:</strong> ${(targetTemp - tolerance).toFixed(1)}¬∞C - ${(targetTemp + tolerance).toFixed(1)}¬∞C</p>`;
            
            // –¢–µ—Å—Ç–∏—Ä—É–µ–º —Å —Ä–∞–∑–Ω—ã–º–∏ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞–º–∏
            const testTemps = [targetTemp - tolerance - 0.1, targetTemp - tolerance, targetTemp, targetTemp + tolerance, targetTemp + tolerance + 0.1];
            
            testTemps.forEach(temp => {
                const roundedTemp = Math.round(temp * 10) / 10;
                const roundedTarget = Math.round(targetTemp * 10) / 10;
                const isInRange = Math.abs(roundedTemp - roundedTarget) <= tolerance;
                
                result += `<p>${temp.toFixed(7)}¬∞C ‚Üí ${roundedTemp.toFixed(1)}¬∞C | –¶–µ–ª—å: ${roundedTarget.toFixed(1)}¬∞C | –í –¥–∏–∞–ø–∞–∑–æ–Ω–µ: <strong>${isInRange ? '‚úÖ –î–ê' : '‚ùå –ù–ï–¢'}</strong></p>`;
            });
            
            document.getElementById('roundingResult').innerHTML = result;
        }

        function testWithRealData() {
            let result = `<h4>–ê–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö –∏–∑ CSV:</h4>`;
            
            const temps = mockData.map(d => d.temperature);
            const minTemp = Math.min(...temps);
            const maxTemp = Math.max(...temps);
            
            result += `<p><strong>–î–∏–∞–ø–∞–∑–æ–Ω —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä:</strong> –æ—Ç ${minTemp.toFixed(2)}¬∞C –¥–æ ${maxTemp.toFixed(2)}¬∞C</p>`;
            result += `<p><strong>–í—Å–µ–≥–æ –∑–∞–ø–∏—Å–µ–π:</strong> ${mockData.length}</p>`;
            result += `<h5>–ü—Ä–∏–º–µ—Ä—ã –∑–∞–ø–∏—Å–µ–π:</h5>`;
            
            mockData.slice(0, 10).forEach(d => {
                result += `<p>${d.timestamp}: ${d.temperature.toFixed(7)}¬∞C ‚Üí ${Math.round(d.temperature * 10) / 10}¬∞C</p>`;
            });
            
            document.getElementById('realDataResult').innerHTML = result;
        }

        function searchTemperature() {
            const searchTemp = parseFloat(document.getElementById('searchTemp').value);
            const searchTol = parseFloat(document.getElementById('searchTol').value);
            
            let result = `<h4>–ü–æ–∏—Å–∫ –¥–ª—è ${searchTemp}¬∞C ¬±${searchTol}¬∞C:</h4>`;
            
            const found = mockData.filter(d => {
                const roundedDataTemp = Math.round(d.temperature * 10) / 10;
                const roundedSearchTemp = Math.round(searchTemp * 10) / 10;
                return Math.abs(roundedDataTemp - roundedSearchTemp) <= searchTol;
            });
            
            result += `<p><strong>–ù–∞–π–¥–µ–Ω–æ –∑–∞–ø–∏—Å–µ–π:</strong> ${found.length}</p>`;
            
            if (found.length > 0) {
                result += `<h5>–ù–∞–π–¥–µ–Ω–Ω—ã–µ –∑–∞–ø–∏—Å–∏:</h5>`;
                found.forEach(d => {
                    result += `<p>${d.timestamp}: ${d.temperature.toFixed(7)}¬∞C ‚Üí ${Math.round(d.temperature * 10) / 10}¬∞C</p>`;
                });
            } else {
                result += `<p>‚ùå –ó–∞–ø–∏—Å–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ —É–≤–µ–ª–∏—á–∏—Ç—å –¥–æ–ø—É—Å–∫.</p>`;
            }
            
            document.getElementById('searchResult').innerHTML = result;
        }

        // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–ø—É—Å–∫–∞–µ–º —Ç–µ—Å—Ç—ã –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        window.onload = function() {
            testRounding();
            testWithRealData();
        };
    </script>
</body>
</html>
